{% extends "base.html" %}

{% block content %}
<!-- Photo Lightbox Modal -->
<div id="lightbox" class="lightbox hidden">
    <div class="lightbox-overlay" onclick="closeLightbox()"></div>
    <button class="lightbox-close" onclick="closeLightbox()" title="Close (Esc)">&times;</button>
    <button class="lightbox-nav lightbox-prev" onclick="navigateLightbox(-1)" title="Previous (←)">‹</button>
    <button class="lightbox-nav lightbox-next" onclick="navigateLightbox(1)" title="Next (→)">›</button>

    <div class="lightbox-main">
        <div class="lightbox-content">
            <div class="lightbox-media" id="lightbox-media"></div>
        </div>
        <div class="lightbox-info">
            <div class="lightbox-meta">
                <div class="lightbox-dates" id="lightbox-dates"></div>
                <div class="lightbox-tags" id="lightbox-tags"></div>
            </div>
        </div>
    </div>
</div>

<!-- Tag Editor Panel -->
<div id="tag-editor-panel" class="tag-editor-panel">
    <div class="tag-editor-header">
        <h3>Edit Tags</h3>
        <button class="tag-editor-close" id="tag-editor-close">&times;</button>
    </div>
    <div class="tag-editor-body">
        <div class="current-tags-section">
            <label>Selected:</label>
            <div id="current-tags-container" class="selected-tags-container">
                <span class="no-tags-hint">No tags selected</span>
            </div>
        </div>
        <div class="tag-search-container">
            <input type="text" id="tag-search" placeholder="Search or add new tag..." autocomplete="off">
        </div>
        <div id="tag-presets-container" class="tag-presets"></div>
        <div id="add-new-tag-section" class="add-new-tag-section hidden">
            <p>Tag "<span id="new-tag-name"></span>" not found</p>
            <div class="category-select">
                <label>Select category:</label>
                <div id="category-buttons" class="category-buttons"></div>
            </div>
            <button id="add-new-tag-btn" class="btn btn-small" disabled>Add to Library</button>
        </div>
    </div>
    <div class="tag-editor-footer">
        <button class="btn btn-secondary">Cancel</button>
        <button id="save-tags-btn" class="btn">Save Changes</button>
    </div>
</div>

<!-- Folder Header -->
<div class="folder-header">
    <div class="folder-header-left">
        <button id="sidebar-toggle" class="sidebar-toggle" title="Toggle folders">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 7h18M3 12h18M3 17h18"/>
            </svg>
        </button>
        <div class="folder-title">
            <h2>Gallery</h2>
            <div class="folder-breadcrumbs" id="folder-breadcrumbs"></div>
        </div>
    </div>
    <div class="folder-header-right">
        <button id="folder-upload-btn" class="folder-action-btn" title="Upload" onclick="openUploadModal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17 8 12 3 7 8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
        </button>
        <button class="folder-action-btn" title="Share" onclick="openShareModal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="18" cy="5" r="3"/>
                <circle cx="6" cy="12" r="3"/>
                <circle cx="18" cy="19" r="3"/>
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
            </svg>
        </button>
        <button class="folder-action-btn" title="Edit folder" onclick="openEditFolder()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/>
            </svg>
        </button>
        <button id="sort-btn" class="folder-action-btn" title="Sort by">Sort</button>
    </div>
</div>

<!-- Selection Menu -->
<div id="selection-menu" class="selection-menu hidden">
    <span id="selection-count">0</span> selected
    <button id="select-all-btn" class="selection-action-btn" title="Select All">All</button>
    <button id="deselect-all-btn" class="selection-action-btn" title="Deselect All">None</button>
    <button id="download-selected-btn" class="selection-action-btn" title="Download">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
    </button>
    <button id="delete-selected-btn" class="selection-action-btn" title="Delete">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
    </button>
</div>

<!-- Search -->
<div class="search-container">
    <input type="text" id="tag-search-input" placeholder="Search..." autocomplete="off">
    <div id="tag-suggestions" class="suggestions hidden"></div>
</div>

<!-- Subfolders section (SPA rendered) -->
<div class="subfolders-section" id="subfolders-section" style="display: none;"></div>

<!-- Gallery grid (SPA rendered) -->
<div class="gallery" id="gallery" style="opacity: 0; transition: opacity 0.15s;">
    <!-- Content loaded via API -->
</div>

<!-- Initial folder ID for init.js -->
<script>
window.INITIAL_FOLDER_ID = '{{ initial_folder_id }}';
</script>
{% endblock %}
